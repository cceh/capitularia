

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overview of the Collation Tool &mdash; Capitularia 0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Meta Search" href="meta_search.html" />
    <link rel="prev" title="HTML Generation" href="html_generation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Capitularia
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#platforms">Platforms</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../overviews.html">Overviews</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="html_generation.html">HTML Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="html_generation.html#xslt-transformations">XSLT Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="html_generation.html#user-delivery">User Delivery</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Overview of the Collation Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-processing-of-the-tei-files">Pre-Processing of the TEI files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collation">Collation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-version-of-collatex">Custom Version of CollateX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="meta_search.html">Meta Search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="meta_search.html#metadata-extraction">Metadata Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="meta_search.html#fulltext-extraction">Fulltext Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="meta_search.html#search">Search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="collections.html">Collections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="collections.html#algorithm">Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webprojekt.html">RRZK Web Projekt Capitularia</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webprojekt/wordpress.html">Wordpress Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webprojekt/database.html">Wordpress Database Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webprojekt/database.html#metadata">Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../webprojekt/wordpress-custom.html">Wordpress Customizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webprojekt/wordpress/theme.html">Wordpress Theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webprojekt/wordpress/plugins.html">Wordpress Plugins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vm.html">Capitularia VM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../vm/app_server.html">Application Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vm/app_server.html#server">server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/app_server.html#module-data_server">data_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/app_server.html#module-collatex_server">collatex_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/app_server.html#module-geo_server">geo_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/app_server.html#module-tile_server">tile_server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vm/database.html">Database Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vm/database.html#schema-capitularia">Schema <em>capitularia:</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/database.html#schema-gis">Schema <em>gis:</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/database.html#db-py">db.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vm/transformations.html">XSLT Transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vm/transformations.html#graph-of-all-transformations">Graph of All Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vm/transformations.html#graph-of-stylesheet-dependencies">Graph of Stylesheet Dependencies</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Capitularia</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../overviews.html">Overviews</a> &raquo;</li>
        
      <li>Overview of the Collation Tool</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/overviews/collation_tool.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overview-of-the-collation-tool">
<span id="collation-tool-overview"></span><h1>Overview of the Collation Tool<a class="headerlink" href="#overview-of-the-collation-tool" title="Permalink to this headline">¶</a></h1>
<p>Description of the collation tool and the processing of the TEI files.</p>
<div class="section" id="pre-processing-of-the-tei-files">
<h2>Pre-Processing of the TEI files<a class="headerlink" href="#pre-processing-of-the-tei-files" title="Permalink to this headline">¶</a></h2>
<p>We extract every chapter of every capitular from all manuscripts and store them
separately in the Postgres database on the application Server.  The text stored
in the database is already normalized.</p>
<p>If a manuscript contains more than one copy of a chapter, all copies are
extracted.  If a corrector hand was active in the chapter, an original and a
corrected version are both extracted.  The collation tool knows about all these
versions and offers them to the user.</p>
<div class="figure align-center" id="id3">
<div  class="pic pic-format-dot">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="573px" preserveAspectRatio="none" style="width:542px;height:573px;" version="1.1" viewBox="0 0 542 573" width="542px" zoomAndPan="magnify"><defs><filter height="300%" id="feovj3bnq09xh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[e1ef416f19a619ed411924d28ede4d44]
cluster VM--><path d="M41.2282,105.3675 C50.7915,90.3028 60.6582,93.5274 70.2412,105.3463 C80.8459,88.0817 91.9075,83.8764 107.1146,100.3103 C116.4064,83.7985 131.3281,86.0183 138.3786,102.4381 C146.0823,87.2983 157.8041,87.9955 166.3906,101.5771 C172.4437,84.4002 185.2541,80.4982 198.4572,94.1367 C209.2286,77.2083 224.6784,74.8178 236.6426,92.8333 C247.2682,79.2563 256.3307,80.9614 264.3537,95.407 C272.8111,80.1408 287.0977,76.9129 297.3994,93.4932 C310.3466,78.1156 321.6723,78.345 332.9485,95.3289 C341.8176,79.5028 355.6127,80.7575 363.2666,96.4962 C373.7328,84.3295 386.1259,84.4655 393.8081,99.6096 C404.3197,84.9218 418.8768,85.7391 428.4679,100.6863 C440.3485,85.771 450.1251,87.4917 458.8676,103.7468 C474.1726,91.0383 486.179,90.1428 496,110 C499.4587,110.4606 500.9063,112.7612 498.8142,115.8789 C512.7909,124.7057 514.06,141.0988 499.0019,150.085 C516.9872,157.368 517.0515,173.1495 501.1029,182.6236 C518.9198,191.2092 518.3577,206.559 502.8967,216.8868 C519.7613,225.1414 523.4998,234.7516 509.4332,249.253 C527.5277,263.57 524.1145,277.0642 507.0093,289.248 C521.9247,297.2051 528.3187,307.5405 513.1323,321.256 C530.6464,336.2711 529.6502,349.7508 507.6199,358.9887 C522.614,367.3365 521.8093,379.8308 509.3937,389.7587 C523.4768,403.0321 521.7088,419.1591 503.4038,427.2591 C517.5916,437.1803 518.0265,452.3835 501.9741,461.0243 C518.3864,472.0994 515.0132,488.2714 498.9003,496.5307 C512.3731,510.2532 509.7576,529.322 489,534 C491.0773,532.6084 493.1098,533.7339 493.085,536.2165 C482.0368,552.7109 470.5028,556.4039 457.2588,538.5036 C446.078,555.0037 434.2113,551.0343 424.5011,536.9295 C416.2747,549.7373 408.0644,551.5804 397.2226,539.8352 C388.7397,554.7619 372.1437,558.1661 363.2364,540.2747 C353.0488,558.4928 342.4161,554.6896 330.4918,542.1219 C321.3493,561.659 308.6417,558.8419 296.4717,545.2288 C286.6895,557.7497 274.7748,557.5511 267.9523,542.2003 C257.5446,560.7305 242.1334,558.2996 231.3787,542.5707 C222.7683,559.739 208.8186,559.487 199.6943,543.0553 C190.8757,556.2613 177.2076,557.1555 168.4701,542.9629 C158.4985,558.3455 146.6632,559.5791 136.4372,543.2196 C124.7275,557.5584 115.1181,552.5723 107.4726,539.0018 C95.069,556.321 82.7645,557.5591 71.4155,537.9716 C54.2307,553.1973 36.9065,550.5723 30,527 C31.3949,527.0633 32.1563,527.6863 31.5774,529.1786 C13.5698,519.8834 13.3078,508.2973 28.7619,496.1496 C11.9731,487.3757 14.304,470.9676 28.8021,462.2308 C11.7271,451.0179 9.4699,434.6876 30.0503,424.728 C12.2347,418.9465 11.6997,403.1864 25.5769,392.9444 C4.5804,380.6516 3.8999,366.6267 24.9736,353.6874 C12.0535,342.7725 11.7779,333.7255 26.7092,324.4648 C8.0843,314.8655 9.5434,299.1069 25.4681,288.3212 C9.3956,276.1424 10.6678,262.4716 28.1571,252.836 C12.7037,244.2268 8.8152,227.824 26.4351,217.5986 C12.8669,207.0615 10.7862,193.6155 28.7092,185.2953 C10.1901,172.9436 11.9491,160.5015 30.1364,149.6182 C8.9484,132.854 15.3001,113.4498 37,103 C39.4317,101.4938 41.2818,102.4353 41.2282,105.3675 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="251" y="120.9951">VM</text><!--MD5=[c80f0d56bca040aa79a2a649a2e57798]
entity cron--><rect fill="#FEFECE" filter="url(#feovj3bnq09xh)" height="46.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="38.5" y="130"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="91.5" y="135"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="89.5" y="137"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="89.5" y="141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="53.5" y="162.9951">Cron</text><!--MD5=[c35cdf1439de4198207974f82c6d0a64]
entity make--><rect fill="#FEFECE" filter="url(#feovj3bnq09xh)" height="46.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="147" y="130"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="223" y="135"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="221" y="137"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="221" y="141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="162" y="162.9951">Makefile</text><!--MD5=[18796deb02f0659c6ca53e1a4bf65658]
entity saxon--><rect fill="#FEFECE" filter="url(#feovj3bnq09xh)" height="46.2969" style="stroke: #A80036; stroke-width: 1.5;" width="209" x="278.5" y="130"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="467.5" y="135"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="465.5" y="137"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="465.5" y="141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="169" x="293.5" y="162.9951">mss-extract-chapters.xsl</text><!--MD5=[0e4e82c954b664e5d225f5849797976f]
entity chapters--><path d="M360,246 C360,236 413,236 413,236 C413,236 466,236 466,246 L466,287.5938 C466,297.5938 413,297.5938 413,297.5938 C413,297.5938 360,297.5938 360,287.5938 L360,246 " fill="#FEFECE" filter="url(#feovj3bnq09xh)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M360,246 C360,256 413,256 413,256 C413,256 466,256 466,246 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="370" y="272.9951">Chapter files</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="377" y="289.292">(plain text)</text><path d="M97.5,254.5 L97.5,279.6328 A0,0 0 0 0 97.5,279.6328 L324.5,279.6328 A0,0 0 0 0 324.5,279.6328 L324.5,272.5 L359.84,267 L324.5,264.5 L324.5,264.5 L314.5,254.5 L97.5,254.5 A0,0 0 0 0 97.5,254.5 " fill="#FBFB77" filter="url(#feovj3bnq09xh)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M314.5,254.5 L314.5,264.5 L324.5,264.5 L314.5,254.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="103.5" y="271.5669">AFS:publ/cache/extracted/*/*.txt</text><!--MD5=[6b4bfa9e00b0b9cc08101d1a1ff13128]
entity import--><rect fill="#FEFECE" filter="url(#feovj3bnq09xh)" height="46.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="199" y="358"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="283" y="363"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="281" y="365"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="281" y="369"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="214" y="390.9951">import.py</text><!--MD5=[7468467f3b6b392f1d176d828c753b77]
entity db--><path d="M205,474 C205,464 251,464 251,464 C251,464 297,464 297,474 L297,515.5938 C297,525.5938 251,525.5938 251,525.5938 C251,525.5938 205,525.5938 205,515.5938 L205,474 " fill="#FEFECE" filter="url(#feovj3bnq09xh)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M205,474 C205,484 251,484 251,484 C251,484 297,484 297,474 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="218" y="500.9951">Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="215" y="517.292">(Postgres)</text><!--MD5=[f43d1bbe4f1159838c5f6e7e47575b7c]
entity tei--><path d="M319.5,18 C319.5,8 383,8 383,8 C383,8 446.5,8 446.5,18 L446.5,59.5938 C446.5,69.5938 383,69.5938 383,69.5938 C383,69.5938 319.5,69.5938 319.5,59.5938 L319.5,18 " fill="#FEFECE" filter="url(#feovj3bnq09xh)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M319.5,18 C319.5,28 383,28 383,28 C383,28 446.5,28 446.5,18 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="329.5" y="44.9951">Manuscript files</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="346.5" y="61.292">(XML+TEI)</text><path d="M138,26.5 L138,51.6328 A0,0 0 0 0 138,51.6328 L284,51.6328 A0,0 0 0 0 284,51.6328 L284,44.5 L319.34,39 L284,36.5 L284,36.5 L274,26.5 L138,26.5 A0,0 0 0 0 138,26.5 " fill="#FBFB77" filter="url(#feovj3bnq09xh)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M274,26.5 L274,36.5 L284,36.5 L274,26.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="144" y="43.5669">AFS:publ/mss/*.xml</text><!--MD5=[98113339b43c387f5e9d8a6bec126949]
link tei to saxon--><path d="M383,70.01 C383,86.9 383,107.83 383,124.32 " fill="none" id="tei-&gt;saxon" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="383,129.72,387,120.72,383,124.72,379,120.72,383,129.72" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[9d5fa5ffe6311e0213407cfd4f3b9eaa]
link saxon to chapters--><path d="M388.93,176.13 C393.11,191.74 398.8,212.99 403.6,230.9 " fill="none" id="saxon-&gt;chapters" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="404.93,235.86,406.4796,226.1338,403.6435,231.0284,398.7489,228.1923,404.93,235.86" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[14428c80e3179678075441161e54033f]
link chapters to import--><path d="M369.59,298.01 C343.8,315.84 311.5,338.18 287.11,355.03 " fill="none" id="chapters-&gt;import" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="282.97,357.9,292.6482,356.0746,287.0835,355.0577,288.1005,349.493,282.97,357.9" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6950bf35f0bdfeef2adfc34e16134539]
link import to db--><path d="M251,404.13 C251,419.61 251,440.63 251,458.44 " fill="none" id="import-&gt;db" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="251,463.86,255,454.86,251,458.86,247,454.86,251,463.86" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[16b2f23e595c1c5de587a32b661386ae]
link cron to make--><path d="M111.56,153 C121.55,153 131.55,153 141.54,153 " fill="none" id="cron-&gt;make" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="146.76,153,137.76,149,141.76,153,137.76,157,146.76,153" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[42211ccb8b439fe830e993a3999a0d06]
link make to saxon--><path d="M243.1,153 C253.11,153 263.11,153 273.12,153 " fill="none" id="make-&gt;saxon" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="278.35,153,269.35,149,273.35,153,269.35,157,278.35,153" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e731f16ea0a8d8bacc8eebde1022f2e9]
link make to import--><path d="M146.8,174.87 C122.01,188.4 94.09,208.64 80,236 C67.38,260.5 65.32,274.68 80,298 C104.76,337.33 154.21,358.22 193.59,369.05 " fill="none" id="make-&gt;import" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="198.83,370.44,191.1577,364.2645,193.9974,369.157,189.1049,371.9967,198.83,370.44" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c0b6d217835289d046c97cb2fa300339]
@startuml
skinparam backgroundColor transparent
skinparam DefaultTextAlignment center
skinparam componentStyle uml2

database  "Manuscript files\n(XML+TEI)"      as tei
note left of tei: AFS:publ/mss/*.xml

cloud "VM" {
  component "Cron"                          as cron
  component "Makefile"                      as make
  component "mss-extract-chapters.xsl"      as saxon
  database  "Chapter files\n(plain text)"   as chapters
  note left of chapters: AFS:publ/cache/extracted/*/*.txt
  component "import.py"                     as import
  database  "Database\n(Postgres)"          as db
}

tei      - -> saxon
saxon    - -> chapters
chapters - -> import
import   - -> db

cron .> make
make .> saxon
make .> import
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Debian-3
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg></div>
<p class="caption"><span class="caption-text">Data flow during pre-processing</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The Makefile is run by cron on the Capitularia VM at regular intervals.</p>
<p>The manuscript files are in the AFS.  The AFS is mounted onto the VM.</p>
<p>The Makefile knows all the dependencies between the files and runs the
appropriate tools to keep the database up-to-date with the manuscript files.</p>
<p>All intermediate files can be found in the cache/extracted directory.  One
directory per manuscript, and one file per chapter, copy, and hand.  The
intermediate files are normalized, eg. have V replaced by U.</p>
<p>The import.py script imports the intermediate text files into the database.</p>
</div>
<div class="section" id="collation">
<h2>Collation<a class="headerlink" href="#collation" title="Permalink to this headline">¶</a></h2>
<p>The collation tool is divided in two parts, one frontend written in JavaScript
and the Vue.js library, and one backend application server written in Python.
The backend retrieves the chapters to collate from the database and calls the
CollateX executable to do the actual collation. The results are sent to the
frontend that does the formatting for display.</p>
<div class="figure align-center" id="id4">
<div  class="pic pic-format-dot">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="377px" preserveAspectRatio="none" style="width:325px;height:377px;" version="1.1" viewBox="0 0 325 377" width="325px" zoomAndPan="magnify"><defs><filter height="300%" id="fatoh9c7dr305" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[e1ef416f19a619ed411924d28ede4d44]
cluster VM--><path d="M39.8191,33.8698 C44.2668,24.7611 50.0982,25.8214 56.2913,31.9876 C61.3558,21.8636 70.3089,23.9103 75.1093,32.2566 C79.1963,24.1348 86.7011,24.7045 91.0073,32.031 C96.6413,24.8513 102.6103,25.5868 107.5046,32.8746 C111.3407,24.1523 119.5158,23.1913 125.4898,30.4718 C131.5506,23.955 137.9212,24.3276 142.271,32.4351 C148.085,22.5683 154.1905,22.8258 161.2433,31.1426 C166.574,24.222 171.6667,22.2611 177.4243,30.6926 C181.7044,21.4007 190.0573,21.8663 194.8074,30.2299 C201.3231,20.3211 209.1054,21.2751 214.6906,31.1644 C220.1335,22.5365 226.449,25.0147 231.1654,31.9343 C236.6503,24.185 244.6883,24.8778 248.2618,33.8846 C253.5658,26.0546 261.4033,26.7156 265.7623,34.9161 C273.8993,25.9679 284.2809,28.5003 289,39 C290.6019,38.4595 291.7355,39.3785 291.6802,41.028 C298.8496,45.2472 299.6755,53.1574 292.0309,57.6884 C301.9728,61.0935 303.0162,68.614 294.5554,74.743 C302.869,79.5601 304.4453,85.0865 296.3224,91.6241 C305.0075,94.916 306.5497,103.0413 299.9746,109.4583 C309.0327,113.8464 309.9991,119.4143 302.3687,126.1903 C311.6196,130.4615 313.4025,137.2174 304.5509,143.7395 C312.232,152.1034 310.0835,158.1221 299.8933,161.9036 C306.4533,166.8209 306.3058,173.2519 298.3054,176.5955 C308.0562,183.4285 305.6795,191.9272 295.8516,196.3251 C305.1915,202.1842 303.2084,208.1989 295.4399,213.6515 C301.3179,219.4551 298.6598,225.6992 291.7119,228.2209 C300.9305,240.5579 296.1976,249.2267 282,252 C283.3216,251.3465 284.1552,251.702 284.1413,253.281 C279.5811,263.305 271.1535,264.2227 264.9762,254.8813 C260.2261,263.2023 254.3677,264.0119 248.0074,256.6202 C244.084,264.3394 238.1819,267.1349 231.7476,259.2339 C227.3738,268.3917 221.0789,266.9984 215.4242,260.5758 C210.2067,269.2321 203.0946,268.8045 197.6592,260.8083 C194.759,269.5533 186.2729,272.956 179.595,264.8605 C175.9344,273.027 167.8902,274.4921 161.9135,267.5756 C155.4512,275.472 147.7772,274.2804 144.256,264.6178 C138.0027,272.7478 131.489,271.516 126.1065,263.631 C118.1055,269.6963 112.538,268.7706 108.3682,259.2662 C103.6699,267.1086 96.906,266.4379 91.9019,259.6093 C84.9598,267.6698 78.686,268.0531 72.6526,258.61 C65.7052,266.3396 57.013,262.7112 54.5282,253.7609 C42.4123,264.1011 33.8284,257.8626 30,245 C31.8459,244.15 33.2527,244.4844 33.3449,246.8336 C25.0942,241.5178 25.0964,236.0795 31.8881,229.4996 C22.0097,225.9754 20.0197,217.6958 28.9522,211.1603 C19.072,207.1456 18.3262,201.2177 26.3729,194.438 C19.3152,189.3985 18.4362,181.5305 26.7474,176.8178 C18.8514,172.7193 17.1211,166.2432 23.9355,159.7247 C16.4417,155.4759 15.1949,149.6833 21.8626,143.6125 C15.2797,138.2294 16.4719,131.8274 23.8253,128.2216 C15.2601,122.2233 18.9082,114.011 26.8108,110.8415 C17.2575,104.1918 16.8037,97.1739 27.1267,90.838 C19.6565,85.2989 21.3582,79.1325 28.6673,75.0341 C21.509,68.4622 22.199,62.3502 30.6561,57.555 C21.5061,46.3624 20.9749,36.943 37,32 C38.7032,31.461 39.668,32.0685 39.8191,33.8698 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="147.5" y="49.9951">VM</text><!--MD5=[7468467f3b6b392f1d176d828c753b77]
entity db--><path d="M47,69 C47,59 93,59 93,59 C93,59 139,59 139,69 L139,110.5938 C139,120.5938 93,120.5938 93,120.5938 C93,120.5938 47,120.5938 47,110.5938 L47,69 " fill="#FEFECE" filter="url(#fatoh9c7dr305)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M47,69 C47,79 93,79 93,79 C93,79 139,79 139,69 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="60" y="95.9951">Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="57" y="112.292">(Postgres)</text><!--MD5=[e2307af040e3f87d22824e7603ca28ec]
entity api--><rect fill="#FEFECE" filter="url(#fatoh9c7dr305)" height="62.5938" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="38.5" y="181"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="127.5" y="186"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="125.5" y="188"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="125.5" y="192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="53.5" y="213.9951">API Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="59" y="230.292">(Python)</text><!--MD5=[06179e17a4f58667031bea30ff214e23]
entity cx--><rect fill="#FEFECE" filter="url(#fatoh9c7dr305)" height="62.5938" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="183" y="181"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="261" y="186"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="259" y="188"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="259" y="192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="198" y="213.9951">CollateX</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="209" y="230.292">(Java)</text><!--MD5=[4a65e84059005d12693a083370a06717]
entity client--><rect fill="#FEFECE" filter="url(#fatoh9c7dr305)" height="62.5938" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="36" y="304"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 1.5;" width="15" x="130" y="309"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="128" y="311"/><rect fill="#FEFECE" height="2" style="stroke: #A80036; stroke-width: 1.5;" width="4" x="128" y="315"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="56.5" y="336.9951">Frontend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="51" y="353.292">(Javascript)</text><!--MD5=[314c9b5bc4dd2dc6e633f2ffbcf881af]
link db to api--><path d="M93,121.1 C93,137.65 93,158.29 93,175.67 " fill="none" id="db-&gt;api" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="93,180.95,97,171.95,93,175.95,89,171.95,93,180.95" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[8bbc512d03c057d4411096abd71c9ff2]
link api to client--><path d="M93,244.03 C93,260.66 93,281.32 93,298.7 " fill="none" id="api-&gt;client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="93,303.98,97,294.98,93,298.98,89,294.98,93,303.98" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[5044fd0ed8a343a6b052e3d200e8e14b]
reverse link api to cx--><path d="M152.81,235.67 C162.82,236.62 172.84,236.09 182.86,234.1 " fill="none" id="api&lt;-cx" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="147.57,235.03,156.0241,240.0825,152.5338,235.6308,156.9854,232.1404,147.57,235.03" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[3fea2d4c4febec761046b87d6bc08f42]
link api to cx--><path d="M147.57,189.97 C157.68,188.49 167.79,188.51 177.9,190.03 " fill="none" id="api-&gt;cx" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="182.86,190.9,174.6812,185.4131,177.9344,190.0409,173.3066,193.2941,182.86,190.9" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2feafb410e83d8cdd2c2f5ab8dadc5df]
@startuml
skinparam backgroundColor transparent
skinparam DefaultTextAlignment center
skinparam componentStyle uml2

cloud "VM" {
  database  "Database\n(Postgres)"   as db
  component "API Server\n(Python)"   as api
  component "CollateX\n(Java)"       as cx
}
component "Frontend\n(Javascript)" as client

db     - -> api
api    - -> client
api    <- cx
api    -> cx
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Debian-3
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg></div>
<p class="caption"><span class="caption-text">Data flow during collation</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>The collation unit is the chapter, so that only short texts need to be collated,
saving much processing time.</p>
<p>We aim to rewrite all the functionality we need of CollateX in Python or
Javascript and then drop the dependency on CollateX.</p>
<p>The Wordpress cap-collation-user plugin delivers the Javascript client to the
user.  After that, all communication happens directly between the client and the
application server.</p>
</div>
<div class="section" id="custom-version-of-collatex">
<span id="custom-collatex"></span><h2>Custom Version of CollateX<a class="headerlink" href="#custom-version-of-collatex" title="Permalink to this headline">¶</a></h2>
<p>Our custom version of CollateX uses a custom word comparison function.</p>
<p>The stock version of CollateX <a class="reference internal" href="#collatex" id="id1"><span>[CollateX]</span></a> uses word comparison functions that
only return binary values, signalling either a match or a mismatch.  Our custom
version uses a word comparison function that returns a similarity value between
0 and 1.  This works much better when aligning variant orthographies of the same
word.</p>
<p>In our custom CollateX we also implemented an enhancement of the
Needleman-Wunsch algorithm by Gotoh. <a class="reference internal" href="#gotoh1982" id="id2"><span>[Gotoh1982]</span></a></p>
<div class="section" id="word-comparison-function">
<h3>Word Comparison Function<a class="headerlink" href="#word-comparison-function" title="Permalink to this headline">¶</a></h3>
<p>The word comparison function returns a similarity value between 0 and 1.</p>
<p>All words in the input texts are split into sets of trigrams.  This is done only
once.  The trigrams are obtained by first prefixing and suffixing the word with
two spaces respectively, then cutting the resulting string it into all possible
strings of length 3.  This means that trigrams may partially overlap each other.</p>
<p>The resulting sets of trigrams are then used in the similarity calculation.</p>
<p>To calculate the similarity between two words, a set is built containing only
the trigrams common to both words.  The magnitude of this set is then compared
against the number of trigrams in both words:</p>
<blockquote>
<div><p>similarity = 2.0 * triAB.size() / (triA.size() + triB.size());</p>
</div></blockquote>
<p>The similarity based on trigrams was chosen because its calculation can be done
in O(n) time whereas a similarity based on Levenshtein distance needs O(n²)
time.  The sets of trigrams for each input word are calculated only once and if
you presort the trigrams in these sets, the common set can be found in O(n)
time.  To be implemented: in a first step gather all trigrams, give each one an
integer id, and later operate on the ids only.  (Maybe hash each trigram onto a
value 0..63 and build a bitmask for each word, later operate on the masks only.)</p>
<dl class="citation">
<dt class="label" id="gotoh1982"><span class="brackets"><a class="fn-backref" href="#id2">Gotoh1982</a></span></dt>
<dd><p>Gotoh, O. 1982,  <em>An Improved Algorithm for Matching Biological
Sequences,</em> J. Mol. Biol. 162, 705-708
<a class="reference external" href="http://jaligner.sourceforge.net/references/gotoh1982.pdf">http://jaligner.sourceforge.net/references/gotoh1982.pdf</a></p>
</dd>
<dt class="label" id="collatex"><span class="brackets"><a class="fn-backref" href="#id1">CollateX</a></span></dt>
<dd><p>Dekker, R.H. et al. 2010-2019, <em>CollateX – Software for Collating
Textual Sources,</em> <a class="reference external" href="https://collatex.net/">https://collatex.net/</a></p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="meta_search.html" class="btn btn-neutral float-right" title="Meta Search" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="html_generation.html" class="btn btn-neutral float-left" title="HTML Generation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-20 CCeH - Licensed under the GNU GPL v3 or later

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>