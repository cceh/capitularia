

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Meta Search &mdash; Capitularia 0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="File Includer" href="file-includer.html" />
    <link rel="prev" title="Collation Tool" href="collation-tool.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Capitularia
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../intro.html#platforms">Platforms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../overviews.html">Overviews</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../overviews/html_generation.html">HTML Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/html_generation.html#xslt-transformations">XSLT Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/html_generation.html#user-delivery">User Delivery</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../overviews/collation_tool.html">Overview of the Collation Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/collation_tool.html#pre-processing-of-the-tei-files">Pre-Processing of the TEI files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/collation_tool.html#collation">Collation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/collation_tool.html#custom-version-of-collatex">Custom Version of CollateX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../overviews/meta_search.html">Meta Search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/meta_search.html#metadata-extraction">Metadata Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/meta_search.html#fulltext-extraction">Fulltext Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/meta_search.html#search">Search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../overviews/collections.html">Collections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../overviews/collections.html#algorithm">Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../webprojekt.html">RRZK Web Projekt Capitularia</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../wordpress.html">Wordpress Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database.html">Wordpress Database Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../database.html#metadata">Metadata</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../../wordpress-custom.html">Wordpress Customizations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../theme.html">Wordpress Theme</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../plugins.html">Wordpress Plugins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../vm.html">Capitularia VM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vm/app_server.html">Application Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/app_server.html#server">server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/app_server.html#module-data_server">data_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/app_server.html#module-collatex_server">collatex_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/app_server.html#module-geo_server">geo_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/app_server.html#module-tile_server">tile_server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../vm/database.html">Database Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/database.html#schema-capitularia">Schema <em>capitularia:</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/database.html#schema-gis">Schema <em>gis:</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/database.html#module-db">db.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../vm/transformations.html">XSLT Transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/transformations.html#graph-of-all-transformations">Graph of All Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vm/transformations.html#graph-of-stylesheet-dependencies">Graph of Stylesheet Dependencies</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Capitularia</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../webprojekt.html">RRZK Web Projekt Capitularia</a> &raquo;</li>
        
          <li><a href="../../wordpress-custom.html">Wordpress Customizations</a> &raquo;</li>
        
          <li><a href="../plugins.html">Wordpress Plugins</a> &raquo;</li>
        
      <li>Meta Search</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/webprojekt/wordpress/plugins/meta-search.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="meta-search">
<span id="id1"></span><h1>Meta Search<a class="headerlink" href="#meta-search" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#plugins-cap-meta-search-cap-meta-search-php" id="id2">plugins/cap-meta-search/cap-meta-search.php</a></p></li>
<li><p><a class="reference internal" href="#plugins-cap-meta-search-class-highlighter-php" id="id3">plugins/cap-meta-search/class-highlighter.php</a></p></li>
<li><p><a class="reference internal" href="#plugins-cap-meta-search-class-meta-search-widget-php" id="id4">plugins/cap-meta-search/class-meta-search-widget.php</a></p></li>
<li><p><a class="reference internal" href="#plugins-cap-meta-search-class-meta-search-php" id="id5">plugins/cap-meta-search/class-meta-search.php</a></p></li>
<li><p><a class="reference internal" href="#plugins-cap-meta-search-functions-php" id="id6">plugins/cap-meta-search/functions.php</a></p></li>
<li><p><a class="reference internal" href="#plugins-meta-search" id="id7">plugins/meta-search</a></p></li>
</ul>
</div>
<span class="target" id="module-plugins.cap-meta-search.cap-meta-search"></span><div class="section" id="plugins-cap-meta-search-cap-meta-search-php">
<h2><a class="toc-backref" href="#id2">plugins/cap-meta-search/cap-meta-search.php</a><a class="headerlink" href="#plugins-cap-meta-search-cap-meta-search-php" title="Permalink to this headline">¶</a></h2>
<p>TEI Metadata Search plugin.</p>
<p>The <em>Meta Search plugin</em> offers metadata-aware and fuzzy fulltext search.  A
search form widget is part of the plugin.  This search box is used on all
manuscript pages.</p>
<p>The meta search uses a different approach than the built-in Wordpress search.
This search is done on the VM server and the unit of search is the capitulary
chapter.  It lets you filter by metadata such as capitularies contained,
dates, and place of origin.</p>
<p>The plugin also provides a snippet and highlighter class for the built-in
Wordpress search, that displays snippets of text around the found terms
instead of the page excerpt.  The highlighter may be used on any Wordpress
page.</p>
<p>See: <a class="reference internal" href="../../../vm/app_server.html#module-data_server" title="data_server"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data_server</span></code></a>, <a class="reference internal" href="../../../overviews/meta_search.html#meta-search-overview"><span class="std std-ref">metadata search overview</span></a>.</p>
<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="const">
<dt id="cceh\capitularia\meta_search\NAME">
<em class="property">constant </em><code class="sig-name descname">NAME</code><a class="headerlink" href="#cceh\capitularia\meta_search\NAME" title="Permalink to this definition">¶</a></dt>
<dd><p>‘Capitularia Meta Search’</p>
<p>The name of the plugin.</p>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="const">
<dt id="cceh\capitularia\meta_search\LANG">
<em class="property">constant </em><code class="sig-name descname">LANG</code><a class="headerlink" href="#cceh\capitularia\meta_search\LANG" title="Permalink to this definition">¶</a></dt>
<dd><p>‘cap-meta-search’</p>
<p>The text domain of the plugin.</p>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="const">
<dt id="cceh\capitularia\meta_search\NONCE_SPECIAL_STRING">
<em class="property">constant </em><code class="sig-name descname">NONCE_SPECIAL_STRING</code><a class="headerlink" href="#cceh\capitularia\meta_search\NONCE_SPECIAL_STRING" title="Permalink to this definition">¶</a></dt>
<dd><p>‘cap_meta_search_nonce’</p>
<p>AJAX security</p>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="const">
<dt id="cceh\capitularia\meta_search\NONCE_PARAM_NAME">
<em class="property">constant </em><code class="sig-name descname">NONCE_PARAM_NAME</code><a class="headerlink" href="#cceh\capitularia\meta_search\NONCE_PARAM_NAME" title="Permalink to this definition">¶</a></dt>
<dd><p>‘_ajax_nonce’</p>
<p>AJAX security</p>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="const">
<dt id="cceh\capitularia\meta_search\HIGHLIGHT">
<em class="property">constant </em><code class="sig-name descname">HIGHLIGHT</code><a class="headerlink" href="#cceh\capitularia\meta_search\HIGHLIGHT" title="Permalink to this definition">¶</a></dt>
<dd><p>‘cap_highlight_words’</p>
<p>The URL query parameter to request word highlighting.</p>
</dd></dl>

<span class="target" id="module-plugins.cap-meta-search.class-highlighter"></span></div>
<div class="section" id="plugins-cap-meta-search-class-highlighter-php">
<h2><a class="toc-backref" href="#id3">plugins/cap-meta-search/class-highlighter.php</a><a class="headerlink" href="#plugins-cap-meta-search-class-highlighter-php" title="Permalink to this headline">¶</a></h2>
<p>Capitularia Meta Search Highlighter</p>
<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="class">
<dt id="cceh\capitularia\meta_search\Highlighter">
<em class="property">class </em><code class="sig-name descname">Highlighter</code><a class="headerlink" href="#cceh\capitularia\meta_search\Highlighter" title="Permalink to this definition">¶</a></dt>
<dd><p>This class provides a snippet view and highlighted search terms for the
built-in Wordpress search.  It displays snippets of text around the found
terms instead of the page excerpt.</p>
<dl class="method">
<dt id="cceh\capitularia\meta_search\Highlighter::get_bounds">
<code class="sig-name descname">get_bounds</code><span class="sig-paren">(</span><em class="sig-param">$content</em>, <em class="sig-param">$content_len</em>, <em class="sig-param">$match</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Highlighter::get_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get start and end of snippet</p>
<p>Given a match returns the start offset (strpos) and end offset of the
snippet in the post content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$content</strong> (<em>string</em>) – The post content.</p></li>
<li><p><strong>$content_len</strong> (<em>integer</em>) – The post content length.</p></li>
<li><p><strong>$match</strong> (<em>object</em>) – The preg_match match structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Begin and end of the snippet.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Highlighter::get_snippets">
<code class="sig-name descname">get_snippets</code><span class="sig-paren">(</span><em class="sig-param">$content</em>, <em class="sig-param">$regex</em>, <em class="sig-param">$max_snippets</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Highlighter::get_snippets" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract snippets from page content.</p>
<p>Given a regex, search a post and return a list of snippets.  The snippets
contain the highlighted search term and a few words of context.  If two
snippets do overlap they are merged.  Snippets are returned formatted as
HTML unordered list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$content</strong> (<em>string</em>) – The post content to search</p></li>
<li><p><strong>$regex</strong> (<em>string</em>) – The regex to search for</p></li>
<li><p><strong>$max_snippets</strong> (<em>integer</em>) – The max. no. of snippets to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTML list of snippets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Highlighter::escape_search_term">
<code class="sig-name descname">escape_search_term</code><span class="sig-paren">(</span><em class="sig-param">$term</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Highlighter::escape_search_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Escape search term for regexp.</p>
<p>Escapes a search term so that preg_* functions can safely use it. ‘#’ is
the preg separator, eg. #term#u .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$term</strong> (<em>string</em>) – The user input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The escaped user input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Highlighter::on_get_the_excerpt">
<code class="sig-name descname">on_get_the_excerpt</code><span class="sig-paren">(</span><em class="sig-param">$content</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Highlighter::on_get_the_excerpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return search results snippets.</p>
<p>Build an excerpt using snippets with highlighted search results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$content</strong> (<em>string</em>) – The unused old excerpt content.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A series of Highlighted snippets.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Highlighter::on_the_content">
<code class="sig-name descname">on_the_content</code><span class="sig-paren">(</span><em class="sig-param">$content</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Highlighter::on_the_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Highlight the search terms in the post.</p>
<p>Highlight the full post if it we came through the search page.  We use
the query string in the HTTP referrer to highlight the content.</p>
<p>The naive approach:</p>
<blockquote>
<div><p>return preg_replace ($regex, ‘&lt;mark&gt;${0}&lt;/mark&gt;’, $content);</p>
</div></blockquote>
<p>did not work because we were also replacing text in HTML
tags and attributes.  This whole rigmarole is needed so
we can parse the content as HTML and then search the text
nodes only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$content</strong> (<em>string</em>) – The post content.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The highlighted post content.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-plugins.cap-meta-search.class-meta-search-widget"></span></div>
<div class="section" id="plugins-cap-meta-search-class-meta-search-widget-php">
<h2><a class="toc-backref" href="#id4">plugins/cap-meta-search/class-meta-search-widget.php</a><a class="headerlink" href="#plugins-cap-meta-search-class-meta-search-widget-php" title="Permalink to this headline">¶</a></h2>
<p>Capitularia Meta Search search box widget</p>
<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="class">
<dt id="cceh\capitularia\meta_search\Widget">
<em class="property">class </em><code class="sig-name descname">Widget</code><a class="headerlink" href="#cceh\capitularia\meta_search\Widget" title="Permalink to this definition">¶</a></dt>
<dd><p>A metadata search box widget.</p>
<dl class="attr">
<dt id="cceh\capitularia\meta_search\Widget::$$title">
<em class="property">property </em><code class="sig-name descname">$title</code><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::$$title" title="Permalink to this definition">¶</a></dt>
<dd><p>The widget title (caption)</p>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::__construct">
<code class="sig-name descname">__construct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::__construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param">$dummy_args</em>, <em class="sig-param">$instance</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the widget</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$dummy_args</strong> (<em>array</em>) – The widget arguments</p></li>
<li><p><strong>$instance</strong> (<em>array</em>) – The widget instance</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::echo_options">
<code class="sig-name descname">echo_options</code><span class="sig-paren">(</span><em class="sig-param">$items</em>, <em class="sig-param">$selected</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::echo_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Echo the &lt;option&gt;s of a &lt;select&gt;.</p>
<p>Echo the &lt;option&gt;s for a HTML &lt;select&gt; element.  Sort numeric substrings
in a sensible way for humans, eg. ‘BK 2’ before ‘BK 12’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$items</strong> (<em>array</em>) – Array of strings: The items to display in the drop-down</p></li>
<li><p><strong>$selected</strong> (<em>string</em>) – The item in the list to select</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::echo_select">
<code class="sig-name descname">echo_select</code><span class="sig-paren">(</span><em class="sig-param">$caption</em>, <em class="sig-param">$id</em>, <em class="sig-param">$items</em>, <em class="sig-param">$tooltip</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::echo_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Echo a HTML &lt;select&gt; element with options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$caption</strong> (<em>string</em>) – The caption for the &lt;select&gt;</p></li>
<li><p><strong>$id</strong> (<em>string</em>) – The xml id and name of the &lt;select&gt;</p></li>
<li><p><strong>$items</strong> (<em>array</em>) – Array of strings: The items to display in the drop-down</p></li>
<li><p><strong>$tooltip</strong> (<em>string</em>) – The tooltip for the &lt;select&gt;</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::echo_places_tree">
<code class="sig-name descname">echo_places_tree</code><span class="sig-paren">(</span><em class="sig-param">$caption</em>, <em class="sig-param">$id</em>, <em class="sig-param">$tooltip</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::echo_places_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Echo a HTML &lt;div&gt; element to contain a jstree of place names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$caption</strong> (<em>string</em>) – The caption for the &lt;select&gt;</p></li>
<li><p><strong>$id</strong> (<em>string</em>) – The xml id and name of the &lt;select&gt;</p></li>
<li><p><strong>$tooltip</strong> (<em>string</em>) – The tooltip for the &lt;select&gt;</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::echo_input">
<code class="sig-name descname">echo_input</code><span class="sig-paren">(</span><em class="sig-param">$caption</em>, <em class="sig-param">$id</em>, <em class="sig-param">$placeholder</em>, <em class="sig-param">$tooltip</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::echo_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Echo a text &lt;input&gt; field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$caption</strong> (<em>string</em>) – The caption for the &lt;input&gt;</p></li>
<li><p><strong>$id</strong> (<em>string</em>) – The xml id and nameof the &lt;input&gt;</p></li>
<li><p><strong>$placeholder</strong> (<em>string</em>) – The placeholder text</p></li>
<li><p><strong>$tooltip</strong> (<em>string</em>) – The tooltip</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::widget">
<code class="sig-name descname">widget</code><span class="sig-paren">(</span><em class="sig-param">$args</em>, <em class="sig-param">$instance</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::widget" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the widget.  Overrides the base class method.</p>
<p>See: WP_Widget::widget()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$args</strong> (<em>array</em>) – Display arguments including ‘before_title’, ‘after_title’, ‘before_widget’, and ‘after_widget’.</p></li>
<li><p><strong>$instance</strong> (<em>array</em>) – The settings for the particular instance of the widget.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">$new_instance</em>, <em class="sig-param">$old_instance</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update widget settings on save.  Overrides the base class method.</p>
<p>See: WP_Widget::update()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$new_instance</strong> (<em>array</em>) – New settings for this instance as input by the user via WP_Widget::form().</p></li>
<li><p><strong>$old_instance</strong> (<em>array</em>) – Old settings for this instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Settings to save or bool false to cancel saving.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::form">
<code class="sig-name descname">form</code><span class="sig-paren">(</span><em class="sig-param">$instance</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::form" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs the widget options form on the admin page. Overrides the base
class method.</p>
<p>See: WP_Widget::form()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$instance</strong> (<em>array</em>) – Current settings.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\Widget::the_option">
<code class="sig-name descname">the_option</code><span class="sig-paren">(</span><em class="sig-param">$instance</em>, <em class="sig-param">$name</em>, <em class="sig-param">$caption</em>, <em class="sig-param">$placeholder</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\Widget::the_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Output one option field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$instance</strong> (<em>array</em>) – The widet options</p></li>
<li><p><strong>$name</strong> (<em>string</em>) – The option name</p></li>
<li><p><strong>$caption</strong> (<em>string</em>) – The caption</p></li>
<li><p><strong>$placeholder</strong> (<em>string</em>) – The placeholder</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-plugins.cap-meta-search.class-meta-search"></span></div>
<div class="section" id="plugins-cap-meta-search-class-meta-search-php">
<h2><a class="toc-backref" href="#id5">plugins/cap-meta-search/class-meta-search.php</a><a class="headerlink" href="#plugins-cap-meta-search-class-meta-search-php" title="Permalink to this headline">¶</a></h2>
<p>Capitularia Meta Search</p>
<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="class">
<dt id="cceh\capitularia\meta_search\MetaSearch">
<em class="property">class </em><code class="sig-name descname">MetaSearch</code><a class="headerlink" href="#cceh\capitularia\meta_search\MetaSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>A query manipulation class.</p>
<dl class="attr">
<dt id="cceh\capitularia\meta_search\MetaSearch::$$json">
<em class="property">property </em><code class="sig-name descname">$json</code><a class="headerlink" href="#cceh\capitularia\meta_search\MetaSearch::$$json" title="Permalink to this definition">¶</a></dt>
<dd><p>The result returned by the App server</p>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\MetaSearch::on_pre_get_posts">
<code class="sig-name descname">on_pre_get_posts</code><span class="sig-paren">(</span><em class="sig-param">$query</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\MetaSearch::on_pre_get_posts" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the meta query on the Capitularia VM server.</p>
<p>Runs the meta query on the server, which returns the ids of the
manuscripts that contain the search terms.  Then builds a Wordpress query
that searches for the pages that contain those manuscripts.</p>
<p>Then the program flow goes back to the normal Wordpress search page,
except that we also provide the snippets to display and the chapter
information.</p>
<p>See: <a class="reference external" href="https://codex.wordpress.org/Class_Reference/WP_Query">https://codex.wordpress.org/Class_Reference/WP_Query</a> Class Reference for WP_Query</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$query</strong> (<em>WP_Query</em>) – The Wordpress query object</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\MetaSearch::on_get_the_excerpt">
<code class="sig-name descname">on_get_the_excerpt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\MetaSearch::on_get_the_excerpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the excerpt for the search result</p>
<p>Return the excerpt generated by the VM Server.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The excerpt (with HTML)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cceh\capitularia\meta_search\MetaSearch::on_get_search_query">
<code class="sig-name descname">on_get_search_query</code><span class="sig-paren">(</span><em class="sig-param">$dummy_message</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\MetaSearch::on_get_search_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Format the contents of the search query variables.</p>
<p>Generate a string like “BK.123 not before 950 and ‘Karl’”.  This hook is
called from the search.php page, and serves to insert the text outside
our widget.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$dummy_message</strong> (<em>string</em>) – The old message</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The message</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-plugins.cap-meta-search.functions"></span></div>
<div class="section" id="plugins-cap-meta-search-functions-php">
<h2><a class="toc-backref" href="#id6">plugins/cap-meta-search/functions.php</a><a class="headerlink" href="#plugins-cap-meta-search-functions-php" title="Permalink to this headline">¶</a></h2>
<p>Capitularia Meta Search global functions</p>
<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\is_meta_search">
<code class="sig-name descname">is_meta_search</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\is_meta_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Should we perform a meta search?</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if this is a meta search.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\is_highlight">
<code class="sig-name descname">is_highlight</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\is_highlight" title="Permalink to this definition">¶</a></dt>
<dd><p>Should we highlight search results?</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\ns">
<code class="sig-name descname">ns</code><span class="sig-paren">(</span><em class="sig-param">$function_name</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\ns" title="Permalink to this definition">¶</a></dt>
<dd><p>Add current namespace</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$function_name</strong> (<em>string</em>) – The class or function name without namespace</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Name with namespace</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\sanitize">
<code class="sig-name descname">sanitize</code><span class="sig-paren">(</span><em class="sig-param">$text</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\sanitize" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanitize a text filed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$text</strong> (<em>string</em>) – The text to sanitize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sanitized text.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cceh\capitularia\meta_search\The</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\get_capitulars">
<code class="sig-name descname">get_capitulars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\get_capitulars" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all capitulars</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All capitulars</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array&lt;mixed,string&gt;</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\on_init">
<code class="sig-name descname">on_init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\on_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Register the translations.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\on_widgets_init">
<code class="sig-name descname">on_widgets_init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\on_widgets_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Register the widget with Wordpress.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\on_query_vars">
<code class="sig-name descname">on_query_vars</code><span class="sig-paren">(</span><em class="sig-param">$vars</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\on_query_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Add our custom HTTP query vars</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$vars</strong> (<em>array</em>) – The stock query vars</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The stock and custom query vars</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\on_cap_meta_search_the_permalink">
<code class="sig-name descname">on_cap_meta_search_the_permalink</code><span class="sig-paren">(</span><em class="sig-param">$permalink</em><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\on_cap_meta_search_the_permalink" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the permalink for the search result</p>
<p>Return a link that will go to the post <em>and</em> highlight the search terms
if followed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$permalink</strong> (<em>string</em>) – The permalink generated by Wordpress</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated permalink</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\on_enqueue_scripts">
<code class="sig-name descname">on_enqueue_scripts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\on_enqueue_scripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Enqueue front side scripts and styles</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="namespace-cceh\capitularia\meta_search"></span><dl class="function">
<dt id="cceh\capitularia\meta_search\on_admin_enqueue_scripts">
<code class="sig-name descname">on_admin_enqueue_scripts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cceh\capitularia\meta_search\on_admin_enqueue_scripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Enqueue admin side scripts and styles</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-plugins/meta-search"></span><div class="section" id="plugins-meta-search">
<h2><a class="toc-backref" href="#id7">plugins/meta-search</a><a class="headerlink" href="#plugins-meta-search" title="Permalink to this headline">¶</a></h2>
<p>File: plugins/cap-meta-search/src/js/front.js</p>
<p>The meta search applet.</p>
<dl class="function">
<dt id="plugins/meta-search.help_init">
<code class="sig-prename descclassname">plugins/meta-search.</code><code class="sig-name descname">help_init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#plugins/meta-search.help_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the help button in the widget.</p>
</dd></dl>

<dl class="function">
<dt id="plugins/meta-search.places_tree_init">
<code class="sig-prename descclassname">plugins/meta-search.</code><code class="sig-name descname">places_tree_init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#plugins/meta-search.places_tree_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the places tree view in the widget.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="file-includer.html" class="btn btn-neutral float-right" title="File Includer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="collation-tool.html" class="btn btn-neutral float-left" title="Collation Tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-20 CCeH - Licensed under the GNU GPL v3 or later

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>